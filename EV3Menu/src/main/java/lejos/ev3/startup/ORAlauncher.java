package lejos.ev3.startup;

import java.io.File;

import lejos.hardware.Button;
import lejos.hardware.ev3.LocalEV3;
import lejos.hardware.lcd.GraphicsLCD;
import lejos.hardware.lcd.Image;
import lejos.utility.Delay;

/**
 * Executes the Open Roberta lab user program after it is downloaded.
 *
 * @author dpyka
 */
public class ORAlauncher {

    private static final String CMD_ORA_RUN = "jrun -jar ";
    private static final String PROGRAMS_DIRECTORY = "/home/lejos/programs";

    private static final String OpenRobertaLabLogo =
        "\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0080\u000f\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00e0\u000f\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0060\u001c\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0060\u0018\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00e0\u0038\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0030\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0030\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0060\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00fe\u0000\u00c0\u0060\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u00ff\u0007\u00c0\u00e0\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00e0\u0083\u001f\u00c0\u00c1\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0078\u0000\u003c\u0080\u00c1\u0001\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u003c\u0000\u0070\u0080\u00ff\u0001\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00fc\u0000\u0000\u00e0\u0003\u0000\u000c\u0000\u00e0\u00f8\u007f\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00fe\u0000\u0000\u00fc\u001f\u0000\u000e\u0000\u00c0\u00ff\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c6\u0000\u0000\u003f\u007c\u00fc\u0007\u0000\u0080\u000f\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c6\u0000\u00c0\u0003\u00e0\u00ff\u0003\u007c\u0000\u0007\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c6\u0000\u00e0\u0001\u00c0\u0087\u0003\u00ff\u0001\u0006\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c6\u0001\u0060\u0000\u0000\u0083\u0001\u0083\u0001\u0006\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0087\u0001\u0070\u0000\u0000\u0086\u0081\u0029\u0003\u0006\u0007\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0087\u0001\u0038\u0000\u0000\u008e\u0081\u006d\u0003\u0006\u0006\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0087\u0001\u0018\u00e0\u0003\u008c\u0081\u006d\u0003\u0006\u0006\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0087\u0001\u001c\u00f0\u0007\u009c\u0081\u007d\u0003\u0086\u0007\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0083\u0003\u000c\u0018\u000c\u0098\u0081\u003b\u0003\u00fe\u0007\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0083\u00e3\u000f\u004c\u0019\u0098\u0001\u00c7\u0001\u00fe\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c3\u00ff\u000f\u006c\u001b\u0098\u0001\u00fe\u0000\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00ff\u003f\u000c\u006c\u001b\u0018\u0003\u007c\u0000\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u007f\u0003\u000c\u00ec\u001b\u0018\u0003\u0000\u0080\u0001\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0007\u000c\u00cc\u0019\u0018\u0007\u0000\u00c0\u0001\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0006\u000c\u0018\u000c\u0018\u000e\u0000\u00c0\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0006\u000c\u00f8\u0007\u0018\u000c\u0000\u0060\u00ff\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0006\u001c\u00e0\u0003\u0018\u003e\u0000\u0070\u00fe\u0007\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0006\u0018\u0000\u0000\u00f8\u007f\u0000\u003c\u000e\u000e\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000e\u003f\u0000\u0000\u00fc\u00e1\u0083\u000f\u00f7\u000c\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00fc\u003f\u0000\u0000\u000e\u0080\u00ff\u0007\u00f3\u001d\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00fc\u0071\u0000\u0000\u0007\u0000\u00fe\u009f\u00bb\u001d\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00e0\u0000\u0080\u0003\u0000\u0000\u00fc\u00b9\r\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0003\u00e0\u0001\u0000\u0000\u00f0\u00f0\r\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0080\u000f\u00f8\u0000\u0000\u0000\u0060\u00e0\u000e\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00fe\u003f\u0000\u0000\u0000\u0070\u0000\u0006\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00f0\u0007\u0000\u0000\u0000\u0038\u0000\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0018\u0080\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000c\u0080\u0001\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000e\u00c0\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0007\u00e0\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0003\u0070\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0080\u0003\u0030\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0001\u0018\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0000\u001c\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0060\u0000\u000e\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0070\u0000\u0006\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0038\u0000\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0018\u0080\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000c\u0080\u0001\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000e\u00c0\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0006\u00e0\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0003\u0070\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0080\u0003\u0030\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0001\u0018\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0000\u001c\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0060\u0000\u000e\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0070\u0000\u0006\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0038\u0000\u0007\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0018\u0080\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000c\u0080\u0001\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000e\u00c0\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0006\u00e0\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0003\u0070\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0080\u0003\u0030\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00fc\u00ff\u0003\u0000\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u007f\u0000\u00f0\u00ff\u00ff\u00ff\u0007\u0000\u00fc\u00ff\u000f\u0080\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u00ff\u0000\u00f8\u00ff\u00ff\u00ff\u000f\u0000\u00fc\u00ff\u003f\u00c0\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u00ff\u0001\u00fc\u00ff\u00ff\u00ff\u001f\u0000\u00fc\u00ff\u00ff\u00e0\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u00ff\u0003\u00fe\u00ff\u00ff\u00ff\u003f\u0000\u00fc\u00ff\u00ff\u00f3\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u007f\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u001f\u0000\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u0003\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u00ff\u0007\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u00ff\u0003\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u00ff\u0001\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u00ff\u0000\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u007f\u0000\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u0018\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u001e\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u0006\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u0000\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00ff\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u0000\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00fd\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u0000\u00ff\u00ff\u00ff\u00ff\u00ff\u0000\u00fc\u00ff\u00f0\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u0000\u00fe\u00ff\u00ff\u00ff\u007f\u0000\u00fc\u007f\u00c0\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u0000\u00fc\u00ff\u00ff\u00ff\u003f\u0000\u00fc\u003f\u0000\u00ff\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u0000\u00f8\u00ff\u00ff\u00ff\u001f\u0000\u00fc\u001f\u0000\u00fc\u00ff\u0087\u00ff\u00ff\u00ff\u00ff\u007f\u00f8\u00ff\u00ff\u00ff\u003f\u0080\u00f0\u00ff\u00ff\u00ff\u000f\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0001\u0000\u0000\u0000\u0040\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00e0\u0000\u0000\u0000\u0000\u00c0\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0070\u0000\u0000\u0000\u0000\u0080\u0001\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0080\u001f\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0030\u0000\u0000\u0000\u0000\u0080\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0001\u0080\u00ff\u001f\u0000\u0000\u0000\u0000\u0018\u0000\u0000\u0000\u0000\u0000\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0000\u00f0\u00ff\u00ff\u0000\u0000\u0000\u0000\u001c\u0000\u0000\u0000\u0000\u0000\u0002\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00e0\u0000\u00fc\u0000\u00f0\u0003\u0000\u0000\u0000\u000c\u0000\u0000\u0000\u0000\u0000\u0002\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00e0\u0000\u000f\u0000\u0000\u000f\u0000\u0000\u0000\u000e\u0000\u00c0\u00ff\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00c0\u0003\u0000\u0000\u003c\u0000\u0000\u0000\u0006\u0000\u00f0\u00ff\u0003\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u00e0\u0000\u0000\u0000\u0070\u0000\u0000\u0000\u0007\u0000\u003c\u0080\u0007\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0070\u0000\u0000\u0000\u00e0\u0000\u0000\u0000\u0003\u0000\u000e\u0000\u000e\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0038\u0000\u0000\u0000\u00c0\u0001\u0000\u0000\u0003\u0000\u0007\u0000\u001c\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000c\u0000\u0000\u0000\u0000\u0003\u0000\u0080\u0001\u0000\u0003\u0000\u0038\u0000\u0000";

    private static final Image image = new Image(178, 128, Utils.stringToBytes8(OpenRobertaLabLogo));

    private static final GraphicsLCD glcd = LocalEV3.get().getGraphicsLCD();

    private static boolean isRunning = false;
    private static int exitvalue = 0;

    public static boolean isRunning() {
        return isRunning;
    }

    public static int getNepoExitValue() {
        return exitvalue;
    }

    /**
     * Executes the user's program as a new java process.
     *
     * @param programName
     *        Filename without directory, for example Linefollower.jar.
     */
    public static int runProgram(String programName) {
        File robertalabFile = new File(ORAlauncher.PROGRAMS_DIRECTORY, programName);
        //System.out.println("ORA executing: " + CMD_ORA_RUN + robertalabFile.getPath());
        GraphicStartup.menu.suspend();
        exec(CMD_ORA_RUN + robertalabFile.getPath(), ORAlauncher.PROGRAMS_DIRECTORY);
        Delay.msDelay(1000);
        GraphicStartup.menu.resume();
        return exitvalue;
    }

    /**
     * Method is based on leJOS program execution. Modified for Open Roberta
     * Lab. No wrapper for sysout and syserr, no stacktrace displaying.
     *
     * @param command
     *        The shell commands to launch the new process.
     * @param directory
     *        The programs where all user programs are saved.
     */
    private static void exec(String command, String directory) {
        Process program = null;
        exitvalue = 0;
        try {
            isRunning = true;
            glcd.clear();
            glcd.refresh();
            glcd.setAutoRefresh(false);

            glcd.drawImage(image, 0, 0, 0);
            glcd.refresh();

            program = new ProcessBuilder(command.split(" ")).directory(new File(directory)).start();

            //System.out.println("Running an Open Roberta Lab Program!");
            while ( true ) {
                int b = Button.getButtons();
                if ( b == 6 ) {
                    System.out.println("Killing the process");
                    program.destroy();
                    GraphicStartup.resetMotors();
                }
                try {
                    // we do not use lejos wrapper for sysout and syserr
                    // this is an alternative method to check if process is terminated
                    // exitvalue is 143 if process was killed by another one
                    // exitvalue is 0 if process terminates regularly
                    // throws exception if not yet terminated
                    exitvalue = program.exitValue();
                    System.out.println("ORA process exitvalue: " + exitvalue);
                    break;
                } catch ( IllegalThreadStateException e ) {
                    // go on
                }
                Delay.msDelay(200);
            }
            program.waitFor();
        } catch ( Exception e ) {
            System.err.println("Failed to execute ORA program: " + e.getMessage());
        } finally {
            Button.LEDPattern(0);
            glcd.setAutoRefresh(true);
            glcd.clear();
            glcd.refresh();
            program = null;
            isRunning = false;
        }
    }

}
